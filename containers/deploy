#!/usr/bin/env bash
set -e

build_and_push () {
    PROJECT=$1
    docker build --tag lesspass/${PROJECT} ./${PROJECT}
    docker tag lesspass/${PROJECT} quay.io/lesspass/${PROJECT}
    docker push quay.io/lesspass/${PROJECT}
}

docker login --username="${QUAY_USERNAME}" --password="${QUAY_PASSWORD}" quay.io
build_and_push webserver
build_and_push backend
build_and_push frontend
